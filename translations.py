"""
Multilingual support for the –ï–ù–¢ preparation bot
Supports Russian (ru), Kazakh (kz), and English (en)
"""

TRANSLATIONS = {
    'ru': {
        # Commands and buttons
        'start_welcome': "üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–æ—Ç–∞ –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –ï–ù–¢!\n\n–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:",
        'language_selected': "‚úÖ –Ø–∑—ã–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: –†—É—Å—Å–∫–∏–π",
        'main_menu': "üìö –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
        'schedule_btn': "üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ",
        'videos_btn': "üé• –í–∏–¥–µ–æ—É—Ä–æ–∫–∏",
        'materials_btn': "üìñ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã",
        'test_btn': "üìù –¢–µ—Å—Ç—ã",
        'top_btn': "üèÜ –†–µ–π—Ç–∏–Ω–≥",
        'quests_btn': "üéØ –ö–≤–µ—Å—Ç—ã",
        'help_btn': "‚ùì –ü–æ–º–æ—â—å",
        'language_btn': "üåê –Ø–∑—ã–∫",
        'game_btn': "üéÆ –í–∏–∫—Ç–æ—Ä–∏–Ω–∞",
        'webapp_btn': "üåê –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
        
        # Schedule
        'schedule_title': "üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π",
        'no_schedule': "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ",
        'schedule_day': "–î–µ–Ω—å",
        'schedule_time': "–í—Ä–µ–º—è",
        'schedule_subject': "–ü—Ä–µ–¥–º–µ—Ç",
        'schedule_topic': "–¢–µ–º–∞",
        
        # Subjects
        'physics': "–§–∏–∑–∏–∫–∞",
        'mathematics': "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞",
        'chemistry': "–•–∏–º–∏—è",
        'biology': "–ë–∏–æ–ª–æ–≥–∏—è",
        'history': "–ò—Å—Ç–æ—Ä–∏—è",
        'geography': "–ì–µ–æ–≥—Ä–∞—Ñ–∏—è",
        'kazakh_lang': "–ö–∞–∑–∞—Ö—Å–∫–∏–π —è–∑—ã–∫",
        'russian_lang': "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫",
        'english_lang': "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫",
        
        # Tests
        'choose_subject': "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:",
        'test_question': "–í–æ–ø—Ä–æ—Å {current}/{total}",
        'test_result': "üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞:\n\n–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: {correct}/{total}\n–ü—Ä–æ—Ü–µ–Ω—Ç: {percentage}%\n–ü–æ–ª—É—á–µ–Ω–æ –æ—á–∫–æ–≤: +{points}",
        'correct_answer': "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!",
        'wrong_answer': "‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: {answer}",
        
        # Leaderboard
        'leaderboard_title': "üèÜ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤",
        'leaderboard_entry': "{position}. {name} - {points} –æ—á–∫–æ–≤ (–£—Ä–æ–≤–µ–Ω—å {level})",
        'your_position': "–í–∞—à–∞ –ø–æ–∑–∏—Ü–∏—è: {position}",
        'your_stats': "üìä –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:\n–û—á–∫–∏: {points}\n–£—Ä–æ–≤–µ–Ω—å: {level}",
        
        # Quests
        'quests_title': "üéØ –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã",
        'quest_entry': "üéØ {title}\nüìù {description}\nüèÜ –ù–∞–≥—Ä–∞–¥–∞: {reward} –æ—á–∫–æ–≤",
        'no_quests': "–ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–≤–µ—Å—Ç–æ–≤ –Ω–µ—Ç",
        
        # Materials
        'materials_title': "üìñ –£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã",
        'choose_material_subject': "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç:",
        'no_materials': "–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",
        
        # Help
        'help_text': """üìö –ü–æ–º–æ—â—å –ø–æ –∫–æ–º–∞–Ω–¥–∞–º:

/start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
/schedule - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
/videos - –í–∏–¥–µ–æ—É—Ä–æ–∫–∏ –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º
/materials - –£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
/test - –ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç
/top - –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤
/quests - –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã
/language - –°–º–µ–Ω–∏—Ç—å —è–∑—ã–∫
/help - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞

üéÆ –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è:
‚Ä¢ –ó–∞ –∫–∞–∂–¥—ã–π –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—á–∫–∏
‚Ä¢ –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 100 –æ—á–∫–æ–≤
‚Ä¢ –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∫–≤–µ—Å—Ç—ã –¥–ª—è –±–æ–Ω—É—Å–Ω—ã—Ö –æ—á–∫–æ–≤""",
        
        # Days of week
        'monday': "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",
        'tuesday': "–í—Ç–æ—Ä–Ω–∏–∫", 
        'wednesday': "–°—Ä–µ–¥–∞",
        'thursday': "–ß–µ—Ç–≤–µ—Ä–≥",
        'friday': "–ü—è—Ç–Ω–∏—Ü–∞",
        'saturday': "–°—É–±–±–æ—Ç–∞",
        'sunday': "–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ",
        
        # Common
        'back': "‚óÄÔ∏è –ù–∞–∑–∞–¥",
        'next': "–î–∞–ª–µ–µ ‚ñ∂Ô∏è",
        'cancel': "‚ùå –û—Ç–º–µ–Ω–∞",
        'loading': "‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...",
    },
    
    'kz': {
        # Commands and buttons
        'start_welcome': "üëã “∞–ë–¢-“ì–∞ –¥–∞–π—ã–Ω–¥–∞–ª—É –±–æ—Ç—ã–Ω–∞ “õ–æ—à –∫–µ–ª–¥—ñ“£—ñ–∑!\n\n–¢—ñ–ª–¥—ñ —Ç–∞“£–¥–∞“£—ã–∑:",
        'language_selected': "‚úÖ –¢—ñ–ª –æ—Ä–Ω–∞—Ç—ã–ª–¥—ã: “ö–∞–∑–∞“õ—à–∞",
        'main_menu': "üìö –ë–∞—Å—Ç—ã –º”ô–∑—ñ—Ä",
        'schedule_btn': "üìÖ –ö–µ—Å—Ç–µ",
        'videos_btn': "üé• –í–∏–¥–µ–æ—Å–∞–±–∞“õ—Ç–∞—Ä",
        'materials_btn': "üìñ –ú–∞—Ç–µ—Ä–∏–∞–ª–¥–∞—Ä",
        'test_btn': "üìù –¢–µ—Å—Ç—Ç–µ—Ä",
        'top_btn': "üèÜ –†–µ–π—Ç–∏–Ω–≥",
        'quests_btn': "üéØ –ö–≤–µ—Å—Ç—Ç–µ—Ä",
        'help_btn': "‚ùì –ö”©–º–µ–∫",
        'language_btn': "üåê –¢—ñ–ª",
        
        # Schedule
        'schedule_title': "üìÖ –°–∞–±–∞“õ –∫–µ—Å—Ç–µ—Å—ñ",
        'no_schedule': "–ö–µ—Å—Ç–µ ”ô–ª—ñ “õ–æ—Å—ã–ª–º–∞“ì–∞–Ω",
        'schedule_day': "–ö“Ø–Ω",
        'schedule_time': "–£–∞“õ—ã—Ç",
        'schedule_subject': "–ü”ô–Ω",
        'schedule_topic': "–¢–∞“õ—ã—Ä—ã–ø",
        
        # Subjects
        'physics': "–§–∏–∑–∏–∫–∞",
        'mathematics': "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞",
        'chemistry': "–•–∏–º–∏—è",
        'biology': "–ë–∏–æ–ª–æ–≥–∏—è", 
        'history': "–¢–∞—Ä–∏—Ö",
        'geography': "–ì–µ–æ–≥—Ä–∞—Ñ–∏—è",
        'kazakh_lang': "“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ",
        'russian_lang': "–û—Ä—ã—Å —Ç—ñ–ª—ñ",
        'english_lang': "–ê“ì—ã–ª—à—ã–Ω —Ç—ñ–ª—ñ",
        
        # Tests
        'choose_subject': "–¢–µ—Å—Ç “Ø—à—ñ–Ω –ø”ô–Ω–¥—ñ —Ç–∞“£–¥–∞“£—ã–∑:",
        'test_question': "–°“±—Ä–∞“õ {current}/{total}",
        'test_result': "üéØ –¢–µ—Å—Ç –Ω”ô—Ç–∏–∂–µ—Å—ñ:\n\n–î“±—Ä—ã—Å –∂–∞—É–∞–ø—Ç–∞—Ä: {correct}/{total}\n–ü–∞–π—ã–∑: {percentage}%\n–ê–ª“ì–∞–Ω “±–ø–∞–π–ª–∞—Ä: +{points}",
        'correct_answer': "‚úÖ –î“±—Ä—ã—Å!",
        'wrong_answer': "‚ùå “ö–∞—Ç–µ. –î“±—Ä—ã—Å –∂–∞—É–∞–ø: {answer}",
        
        # Leaderboard
        'leaderboard_title': "üèÜ –¢–æ–ø –æ–π—ã–Ω—à—ã–ª–∞—Ä",
        'leaderboard_entry': "{position}. {name} - {points} “±–ø–∞–π (–î–µ“£–≥–µ–π {level})",
        'your_position': "–°—ñ–∑–¥—ñ“£ –æ—Ä–Ω—ã“£—ã–∑: {position}",
        'your_stats': "üìä –°—ñ–∑–¥—ñ“£ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞“£—ã–∑:\n–£–ø–∞–π–ª–∞—Ä: {points}\n–î–µ“£–≥–µ–π: {level}",
        
        # Quests
        'quests_title': "üéØ –ë–µ–ª—Å–µ–Ω–¥—ñ –∫–≤–µ—Å—Ç—Ç–µ—Ä",
        'quest_entry': "üéØ {title}\nüìù {description}\nüèÜ –°—ã–π–ª—ã“õ: {reward} “±–ø–∞–π",
        'no_quests': "–ë–µ–ª—Å–µ–Ω–¥—ñ –∫–≤–µ—Å—Ç—Ç–µ—Ä –∂–æ“õ",
        
        # Materials
        'materials_title': "üìñ –û“õ—É –º–∞—Ç–µ—Ä–∏–∞–ª–¥–∞—Ä—ã",
        'choose_material_subject': "–ü”ô–Ω–¥—ñ —Ç–∞“£–¥–∞“£—ã–∑:",
        'no_materials': "–ú–∞—Ç–µ—Ä–∏–∞–ª–¥–∞—Ä —Ç–∞–±—ã–ª–º–∞–¥—ã",
        
        # Help
        'help_text': """üìö –ö–æ–º–∞–Ω–¥–∞–ª–∞—Ä –±–æ–π—ã–Ω—à–∞ –∫”©–º–µ–∫:

/start - –ë–æ—Ç–ø–µ–Ω –∂“±–º—ã—Å—Ç—ã –±–∞—Å—Ç–∞—É
/schedule - –ö–µ—Å—Ç–µ–Ω—ñ “õ–∞—Ä–∞—É
/videos - –ü”ô–Ω–¥–µ—Ä –±–æ–π—ã–Ω—à–∞ –≤–∏–¥–µ–æ—Å–∞–±–∞“õ—Ç–∞—Ä
/materials - –û“õ—É –º–∞—Ç–µ—Ä–∏–∞–ª–¥–∞—Ä—ã
/test - –¢–µ—Å—Ç —Ç–∞–ø—Å—ã—Ä—É
/top - –õ–∏–¥–µ—Ä–ª–µ—Ä –∫–µ—Å—Ç–µ—Å—ñ
/quests - –ë–µ–ª—Å–µ–Ω–¥—ñ –∫–≤–µ—Å—Ç—Ç–µ—Ä
/language - –¢—ñ–ª–¥—ñ ”©–∑–≥–µ—Ä—Ç—É
/help - –ë“±–ª –∞–Ω—ã“õ—Ç–∞–º–∞

üéÆ –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è:
‚Ä¢ ”ò—Ä —Ç–∞–ø—Å—ã—Ä—ã–ª“ì–∞–Ω —Ç–µ—Å—Ç “Ø—à—ñ–Ω “±–ø–∞–π –∞–ª–∞—Å—ã–∑
‚Ä¢ –î–µ“£–≥–µ–π ”ô—Ä 100 “±–ø–∞–π“ì–∞ –∫”©—Ç–µ—Ä—ñ–ª–µ–¥—ñ
‚Ä¢ –ë–æ–Ω—É—Å “±–ø–∞–π–ª–∞—Ä “Ø—à—ñ–Ω –∫–≤–µ—Å—Ç—Ç–µ—Ä–¥—ñ –æ—Ä—ã–Ω–¥–∞“£—ã–∑""",
        
        # Days of week
        'monday': "–î“Ø–π—Å–µ–Ω–±—ñ",
        'tuesday': "–°–µ–π—Å–µ–Ω–±—ñ",
        'wednesday': "–°”ô—Ä—Å–µ–Ω–±—ñ", 
        'thursday': "–ë–µ–π—Å–µ–Ω–±—ñ",
        'friday': "–ñ“±–º–∞",
        'saturday': "–°–µ–Ω–±—ñ",
        'sunday': "–ñ–µ–∫—Å–µ–Ω–±—ñ",
        
        # Common
        'back': "‚óÄÔ∏è –ê—Ä—Ç“õ–∞",
        'next': "–ö–µ–ª–µ—Å—ñ ‚ñ∂Ô∏è",
        'cancel': "‚ùå –ë–æ–ª–¥—ã—Ä–º–∞—É",
        'loading': "‚è≥ –ñ“Ø–∫—Ç–µ–ª—É–¥–µ...",
    },
    
    'en': {
        # Commands and buttons
        'start_welcome': "üëã Welcome to the UNT preparation bot!\n\nChoose your language:",
        'language_selected': "‚úÖ Language set: English",
        'main_menu': "üìö Main Menu",
        'schedule_btn': "üìÖ Schedule",
        'videos_btn': "üé• Video Lessons",
        'materials_btn': "üìñ Materials",
        'test_btn': "üìù Tests",
        'top_btn': "üèÜ Leaderboard",
        'quests_btn': "üéØ Quests",
        'help_btn': "‚ùì Help",
        'language_btn': "üåê Language",
        
        # Schedule
        'schedule_title': "üìÖ Class Schedule",
        'no_schedule': "No schedule added yet",
        'schedule_day': "Day",
        'schedule_time': "Time",
        'schedule_subject': "Subject",
        'schedule_topic': "Topic",
        
        # Subjects
        'physics': "Physics",
        'mathematics': "Mathematics",
        'chemistry': "Chemistry",
        'biology': "Biology",
        'history': "History",
        'geography': "Geography",
        'kazakh_lang': "Kazakh Language",
        'russian_lang': "Russian Language",
        'english_lang': "English Language",
        
        # Tests
        'choose_subject': "Choose subject for testing:",
        'test_question': "Question {current}/{total}",
        'test_result': "üéØ Test Result:\n\nCorrect answers: {correct}/{total}\nPercentage: {percentage}%\nPoints earned: +{points}",
        'correct_answer': "‚úÖ Correct!",
        'wrong_answer': "‚ùå Wrong. Correct answer: {answer}",
        
        # Leaderboard
        'leaderboard_title': "üèÜ Top Players",
        'leaderboard_entry': "{position}. {name} - {points} points (Level {level})",
        'your_position': "Your position: {position}",
        'your_stats': "üìä Your Statistics:\nPoints: {points}\nLevel: {level}",
        
        # Quests
        'quests_title': "üéØ Active Quests",
        'quest_entry': "üéØ {title}\nüìù {description}\nüèÜ Reward: {reward} points",
        'no_quests': "No active quests",
        
        # Materials
        'materials_title': "üìñ Study Materials",
        'choose_material_subject': "Choose subject:",
        'no_materials': "No materials found",
        
        # Help
        'help_text': """üìö Command Help:

/start - Start using the bot
/schedule - View schedule
/videos - Video lessons by subject
/materials - Study materials
/test - Take a test
/top - Leaderboard
/quests - Active quests
/language - Change language
/help - This help

üéÆ Gamification:
‚Ä¢ Earn points for each completed test
‚Ä¢ Level up every 100 points
‚Ä¢ Complete quests for bonus points""",
        
        # Days of week
        'monday': "Monday",
        'tuesday': "Tuesday",
        'wednesday': "Wednesday",
        'thursday': "Thursday", 
        'friday': "Friday",
        'saturday': "Saturday",
        'sunday': "Sunday",
        
        # Common
        'back': "‚óÄÔ∏è Back",
        'next': "Next ‚ñ∂Ô∏è",
        'cancel': "‚ùå Cancel",
        'loading': "‚è≥ Loading...",
    }
}

def get_text(key: str, language: str = 'ru', **kwargs) -> str:
    """Get translated text by key and language"""
    if language not in TRANSLATIONS:
        language = 'ru'  # fallback to Russian
    
    text = TRANSLATIONS[language].get(key, TRANSLATIONS['ru'].get(key, key))
    
    # Format with provided kwargs
    try:
        return text.format(**kwargs)
    except (KeyError, ValueError):
        return text

def get_language_keyboard():
    """Get language selection keyboard"""
    from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
    
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [
            InlineKeyboardButton(text="üá∑üá∫ –†—É—Å—Å–∫–∏–π", callback_data="lang_ru"),
            InlineKeyboardButton(text="üá∞üáø “ö–∞–∑–∞“õ—à–∞", callback_data="lang_kz"),
        ],
        [
            InlineKeyboardButton(text="üá¨üáß English", callback_data="lang_en"),
        ]
    ])
    return keyboard

def get_main_menu_keyboard(language: str = 'ru'):
    """Get main menu keyboard"""
    from aiogram.types import ReplyKeyboardMarkup, KeyboardButton, WebAppInfo
    
    keyboard = ReplyKeyboardMarkup(
        keyboard=[
            [
                KeyboardButton(text=get_text('schedule_btn', language)),
                KeyboardButton(text=get_text('videos_btn', language)),
            ],
            [
                KeyboardButton(text=get_text('materials_btn', language)),
                KeyboardButton(text=get_text('test_btn', language)),
            ],
            [
                KeyboardButton(text=get_text('top_btn', language)),
                KeyboardButton(text=get_text('quests_btn', language)),
            ],
            [
                KeyboardButton(
                    text=get_text('webapp_btn', language),
                    web_app=WebAppInfo(url="https://your-domain.com/ent_web_app/index.html")
                ),
                KeyboardButton(text=get_text('help_btn', language)),
            ],
            [
                KeyboardButton(text=get_text('language_btn', language)),
            ]
        ],
        resize_keyboard=True,
        one_time_keyboard=False
    )
    return keyboard

def get_subjects_keyboard(language: str = 'ru'):
    """Get subjects selection keyboard - Physics and Mathematics only"""
    from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
    
    subjects = [
        ('physics', 'physics'),
        ('mathematics', 'mathematics'),
    ]
    
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(
            text=get_text(subject_key, language),
            callback_data=f"subject_{subject_value}"
        )] for subject_key, subject_value in subjects
    ])
    return keyboard
